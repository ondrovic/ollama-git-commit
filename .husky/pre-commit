# Prevent infinite loop
if [ "$PRE_COMMIT_RUNNING" = "1" ]; then
  exit 0
fi
export PRE_COMMIT_RUNNING=1

bun test
npx lint-staged
bun run update-version

# If there are any changes from lint-staged, amend them to the current commit
if git diff --cached --quiet; then
  echo "No changes to amend"
else
  git commit --amend --no-edit
fi
